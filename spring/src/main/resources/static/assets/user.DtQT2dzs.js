import{c as e,o as t,w as s,r,a as i,i as l,v as a,n as o,q as n,b as u,d as h,t as m,x as d,y as f}from "./index-B7Dt8O4Z.js";import{_ as c}from "./uni-app.es.CJ55vtPu.js";const g=c({name:"uniFormsItem",options:{virtualHost:!0},provide(){return{uniFormItem:this}},inject:{form:{from:"uniForm",default:null}},props:{rules:{type:Array,default:()=>null},name:{type:[String,Array],default:""},required:{type:Boolean,default:!1},label:{type:String,default:""},labelWidth:{type:[String,Number],default:""},labelAlign:{type:String,default:""},errorMessage:{type:[String,Boolean],default:""},leftIcon:String,iconColor:{type:String,default:"#606266"}},data:()=>({errMsg:"",userRules:null,localLabelAlign:"left",localLabelWidth:"70px",localLabelPos:"left",border:!1,isFirstBorder:!1}),computed:{msg(){return this.errorMessage||this.errMsg}},watch:{"form.formRules"(e){this.init()},"form.labelWidth"(e){this.localLabelWidth=this._labelWidthUnit(e)},"form.labelPosition"(e){this.localLabelPos=this._labelPosition()},"form.labelAlign"(e){}},created(){this.init(!0),this.name&&this.form&&this.$watch((()=>this.form._getDataValue(this.name,this.form.localData)),((e, t)=>{if(!this.form._isEqual(e,t)){const t=this.itemSetValue(e);this.onFieldChange(t,!1)}}),{immediate:!1})},unmounted(){this.__isUnmounted=!0,this.unInit()},methods:{setRules(e=null){this.userRules=e,this.init(!1)},setValue(){},async onFieldChange(e, t=!0){const{formData:s,localData:r,errShowType:i,validateCheck:l,validateTrigger:a,_isRequiredField:o,_realName:n}=this.form,u=n(this.name);e||(e=this.form.formData[u]);const h=this.itemRules.rules&&this.itemRules.rules.length;if(!this.validator||!h||0===h)return;const m=o(this.itemRules.rules||[]);let c=null;return"bind"===a||t?(c=await this.validator.validateUpdate({[u]:e},s),m||void 0!==e&&""!==e||(c=null),c&&c.errorMessage?("undertext"===i&&(this.errMsg=c?c.errorMessage:""),"toast"===i&&d({title:c.errorMessage||"校验错误",icon:"none"}),"modal"===i&&f({title:"提示",content:c.errorMessage||"校验错误"})):this.errMsg="",l(c||null)):this.errMsg="",c||null},init(e=!1){const{validator:t,formRules:s,childrens:r,formData:i,localData:l,_realName:a,labelWidth:o,_getDataValue:n,_setDataValue:u}=this.form||{};if(this.localLabelAlign=this._justifyContent(),this.localLabelWidth=this._labelWidthUnit(o),this.localLabelPos=this._labelPosition(),this.form&&e&&r.push(this),!t||!s)return;this.form.isFirstBorder||(this.form.isFirstBorder=!0,this.isFirstBorder=!0),this.group&&(this.group.isFirstBorder||(this.group.isFirstBorder=!0,this.isFirstBorder=!0)),this.border=this.form.border;const h=a(this.name),m=this.userRules||this.rules;"object"==typeof s&&m&&(s[h]={rules:m},t.updateSchema(s));const d=s[h]||{};this.itemRules=d,this.validator=t,this.itemSetValue(n(this.name,l))},unInit(){if(this.form){const{childrens:e,formData:t,_realName:s}=this.form;e.forEach(((e, r)=>{e===this&&(this.form.childrens.splice(r,1),delete t[s(e.name)])}))}},itemSetValue(e){const t=this.form._realName(this.name),s=this.itemRules.rules||[],r=this.form._getValue(t,e,s);return this.form._setDataValue(t,this.form.formData,r),r},clearValidate(){this.errMsg=""},_isRequired(){return this.required},_justifyContent(){if(this.form){const{labelAlign:e}=this.form;let t=this.labelAlign?this.labelAlign:e;if("left"===t)return"flex-start";if("center"===t)return"center";if("right"===t)return"flex-end"}return"flex-start"},_labelWidthUnit(e){return this.num2px(this.labelWidth?this.labelWidth:e||(this.label?70:"auto"))},_labelPosition(){return this.form&&this.form.labelPosition||"left"},isTrigger:(e, t, s)=>"submit"!==e&&e?"bind":void 0===e?"bind"!==t?t?"submit":""===s?"bind":"submit":"bind":"submit",num2px: e=>"number"==typeof e?`${e}px`:e}},[["render",function(d, f, c, g, b, _){const p=u,y=l;return t(),e(y,{class:o(["uni-forms-item",["is-direction-"+b.localLabelPos,b.border?"uni-forms-item--border":"",b.border&&b.isFirstBorder?"is-first-border":""]])},{default:s((()=>[r(d.$slots,"label",{},(()=>[i(y,{class:o(["uni-forms-item__label",{"no-label":!c.label&&!c.required}]),style:a({width:b.localLabelWidth,justifyContent:b.localLabelAlign})},{default:s((()=>[c.required?(t(),e(p,{key:0,class:"is-required"},{default:s((()=>[h("*")])),_:1})):n("",!0),i(p,null,{default:s((()=>[h(m(c.label),1)])),_:1})])),_:1},8,["class","style"])]),!0),i(y,{class:"uni-forms-item__content"},{default:s((()=>[r(d.$slots,"default",{},void 0,!0),i(y,{class:o(["uni-forms-item__error",{"msg--active":_.msg}])},{default:s((()=>[i(p,null,{default:s((()=>[h(m(_.msg),1)])),_:1})])),_:1},8,["class"])])),_:3})])),_:3},8,["class"])}],["__scopeId","data-v-1250f1e3"]]);class b{}var _=(e=>(e[e.GET=1]="GET",e[e.PUT=2]="PUT",e[e.DELETE=4]="DELETE",e[e.POST=8]="POST",e))(_||{});const p={name:{rules:[{required:!0,errorMessage:"不能为空"}]},account:{rules:[{required:!0,errorMessage:"不能为空"},{minLength:8,maxLength:16,errorMessage:"长度应该在8~16个字符"}]},password:{rules:[{required:!0,errorMessage:"不能为空"},{minLength:8,maxLength:16,errorMessage:"长度应该在8~16个字符"}]},email:{rules:[{format:"email",errorMessage:"不是可用的邮箱格式"}]},phone:{rules:[{pattern:new RegExp("^1[3-9]\\d{9}$"),errorMessage:"不是可用的手机号格式"}]}};export{_ as P,b as U,g as _,p as u};
