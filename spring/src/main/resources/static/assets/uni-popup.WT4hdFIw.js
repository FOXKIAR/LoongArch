import{_ as t,r as e,a as i}from "./uni-app.es.CJ55vtPu.js";import{j as s,c as a,o as r,w as o,a as n,i as l,v as u,n as h,q as c,r as d,g as m,aa as p,a1 as f,F as g,ab as y,ac as b,ad as k,a7 as v,a8 as w,a4 as x,U as C}from "./index-B7Dt8O4Z.js";function S(t){let e="";for(let i in t){e+=`${i}:${t[i]};`}return e}const $=t({name:"uni-easyinput",emits:["click","iconClick","update:modelValue","input","focus","blur","confirm","clear","eyes","change","keyboardheightchange"],model:{prop:"modelValue",event:"update:modelValue"},options:{virtualHost:!0},inject:{form:{from:"uniForm",default:null},formItem:{from:"uniFormItem",default:null}},props:{name:String,value:[Number,String],modelValue:[Number,String],type:{type:String,default:"text"},clearable:{type:Boolean,default:!0},autoHeight:{type:Boolean,default:!1},placeholder:{type:String,default:" "},placeholderStyle:String,focus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxlength:{type:[Number,String],default:140},confirmType:{type:String,default:"done"},clearSize:{type:[Number,String],default:24},inputBorder:{type:Boolean,default:!0},prefixIcon:{type:String,default:""},suffixIcon:{type:String,default:""},trim:{type:[Boolean,String],default:!1},cursorSpacing:{type:Number,default:0},passwordIcon:{type:Boolean,default:!0},adjustPosition:{type:Boolean,default:!0},primaryColor:{type:String,default:"#2979ff"},styles:{type:Object,default:()=>({color:"#333",backgroundColor:"#fff",disableColor:"#F7F6F6",borderColor:"#e5e5e5"})},errorMessage:{type:[String,Boolean],default:""}},data:()=>({focused:!1,val:"",showMsg:"",border:!1,isFirstBorder:!1,showClearIcon:!1,showPassword:!1,focusShow:!1,localMsg:"",isEnter:!1}),computed:{isVal(){const t=this.val;return!(!t&&0!==t)},msg(){return this.localMsg||this.errorMessage},inputMaxlength(){return Number(this.maxlength)},boxStyle(){return`color:${this.inputBorder&&this.msg?"#e43d33":this.styles.color};`},inputContentClass(){return function(t){let e="";for(let i in t)t[i]&&(e+=`${i} `);return e}({"is-input-border":this.inputBorder,"is-input-error-border":this.inputBorder&&this.msg,"is-textarea":"textarea"===this.type,"is-disabled":this.disabled,"is-focused":this.focusShow})},inputContentStyle(){const t=this.focusShow?this.primaryColor:this.styles.borderColor;return S({"border-color":(this.inputBorder&&this.msg?"#dd524d":t)||"#e5e5e5","background-color":this.disabled?this.styles.disableColor:this.styles.backgroundColor})},inputStyle(){return S({"padding-right":"password"===this.type||this.clearable||this.prefixIcon?"":"10px","padding-left":this.prefixIcon?"":"10px"})}},watch:{value(t){this.val=null!==t?t:""},modelValue(t){this.val=null!==t?t:""},focus(t){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))}},created(){this.init(),this.form&&this.formItem&&this.$watch("formItem.errMsg",(t=>{this.localMsg=t}))},mounted(){this.$nextTick((()=>{this.focused=this.focus,this.focusShow=this.focus}))},methods:{init(){this.value||0===this.value?this.val=this.value:this.modelValue||0===this.modelValue||""===this.modelValue?this.val=this.modelValue:this.val=""},onClickIcon(t){this.$emit("iconClick",t)},onEyes(){this.showPassword=!this.showPassword,this.$emit("eyes",this.showPassword)},onInput(t){let e=t.detail.value;this.trim&&("boolean"==typeof this.trim&&this.trim&&(e=this.trimStr(e)),"string"==typeof this.trim&&(e=this.trimStr(e,this.trim))),this.errMsg&&(this.errMsg=""),this.val=e,this.$emit("input",e),this.$emit("update:modelValue",e)},onFocus(){this.$nextTick((()=>{this.focused=!0})),this.$emit("focus",null)},_Focus(t){this.focusShow=!0,this.$emit("focus",t)},onBlur(){this.focused=!1,this.$emit("blur",null)},_Blur(t){if(t.detail.value,this.focusShow=!1,this.$emit("blur",t),!1===this.isEnter&&this.$emit("change",this.val),this.form&&this.formItem){const{validateTrigger:t}=this.form;"blur"===t&&this.formItem.onFieldChange()}},onConfirm(t){this.$emit("confirm",this.val),this.isEnter=!0,this.$emit("change",this.val),this.$nextTick((()=>{this.isEnter=!1}))},onClear(t){this.val="",this.$emit("input",""),this.$emit("update:modelValue",""),this.$emit("clear")},onkeyboardheightchange(t){this.$emit("keyboardheightchange",t)},trimStr:(t, e="both")=>"both"===e?t.trim():"left"===e?t.trimLeft():"right"===e?t.trimRight():"start"===e?t.trimStart():"end"===e?t.trimEnd():"all"===e?t.replace(/\s+/g,""):t}},[["render",function(t, y, b, k, v, w){const x=e(s("uni-icons"),i),C=p,S=f,$=l;return r(),a($,{class:h(["uni-easyinput",{"uni-easyinput-error":w.msg}]),style:u(w.boxStyle)},{default:o((()=>[n($,{class:h(["uni-easyinput__content",w.inputContentClass]),style:u(w.inputContentStyle)},{default:o((()=>[b.prefixIcon?(r(),a(x,{key:0,class:"content-clear-icon",type:b.prefixIcon,color:"#c0c4cc",onClick:y[0]||(y[0]= t=>w.onClickIcon("prefix")),size:"22"},null,8,["type"])):c("",!0),d(t.$slots,"left",{},void 0,!0),"textarea"===b.type?(r(),a(C,{key:1,class:h(["uni-easyinput__content-textarea",{"input-padding":b.inputBorder}]),name:b.name,value:v.val,placeholder:b.placeholder,placeholderStyle:b.placeholderStyle,disabled:b.disabled,"placeholder-class":"uni-easyinput__placeholder-class",maxlength:w.inputMaxlength,focus:v.focused,autoHeight:b.autoHeight,"cursor-spacing":b.cursorSpacing,"adjust-position":b.adjustPosition,onInput:w.onInput,onBlur:w._Blur,onFocus:w._Focus,onConfirm:w.onConfirm,onKeyboardheightchange:w.onkeyboardheightchange},null,8,["class","name","value","placeholder","placeholderStyle","disabled","maxlength","focus","autoHeight","cursor-spacing","adjust-position","onInput","onBlur","onFocus","onConfirm","onKeyboardheightchange"])):(r(),a(S,{key:2,type:"password"===b.type?"text":b.type,class:"uni-easyinput__content-input",style:u(w.inputStyle),name:b.name,value:v.val,password:!v.showPassword&&"password"===b.type,placeholder:b.placeholder,placeholderStyle:b.placeholderStyle,"placeholder-class":"uni-easyinput__placeholder-class",disabled:b.disabled,maxlength:w.inputMaxlength,focus:v.focused,confirmType:b.confirmType,"cursor-spacing":b.cursorSpacing,"adjust-position":b.adjustPosition,onFocus:w._Focus,onBlur:w._Blur,onInput:w.onInput,onConfirm:w.onConfirm,onKeyboardheightchange:w.onkeyboardheightchange},null,8,["type","style","name","value","password","placeholder","placeholderStyle","disabled","maxlength","focus","confirmType","cursor-spacing","adjust-position","onFocus","onBlur","onInput","onConfirm","onKeyboardheightchange"])),"password"===b.type&&b.passwordIcon?(r(),m(g,{key:3},[w.isVal?(r(),a(x,{key:0,class:h(["content-clear-icon",{"is-textarea-icon":"textarea"===b.type}]),type:v.showPassword?"eye-slash-filled":"eye-filled",size:22,color:v.focusShow?b.primaryColor:"#c0c4cc",onClick:w.onEyes},null,8,["class","type","color","onClick"])):c("",!0)],64)):c("",!0),b.suffixIcon?(r(),m(g,{key:4},[b.suffixIcon?(r(),a(x,{key:0,class:"content-clear-icon",type:b.suffixIcon,color:"#c0c4cc",onClick:y[1]||(y[1]= t=>w.onClickIcon("suffix")),size:"22"},null,8,["type"])):c("",!0)],64)):(r(),m(g,{key:5},[b.clearable&&w.isVal&&!b.disabled&&"textarea"!==b.type?(r(),a(x,{key:0,class:h(["content-clear-icon",{"is-textarea-icon":"textarea"===b.type}]),type:"clear",size:b.clearSize,color:w.msg?"#dd524d":v.focusShow?b.primaryColor:"#c0c4cc",onClick:w.onClear},null,8,["class","size","color","onClick"])):c("",!0)],64)),d(t.$slots,"right",{},void 0,!0)])),_:3},8,["class","style"])])),_:3},8,["class","style"])}],["__scopeId","data-v-da2f0c35"]]);var _={email:/^\S+?@\S+?\.\S+?$/,idcard:/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i")};const T={int:"integer",bool:"boolean",double:"number",long:"number",password:"string"};function M(t, e=""){["label"].forEach((e=>{void 0===t[e]&&(t[e]="")}));let i=e;for(let s in t){let e=new RegExp("{"+s+"}");i=i.replace(e,t[s])}return i}const A={integer: t=>A.number(t)&&parseInt(t,10)===t,string: t=>"string"==typeof t,number: t=>!isNaN(t)&&"number"==typeof t,boolean:function(t){return"boolean"==typeof t},float:function(t){return A.number(t)&&!A.integer(t)},array: t=>Array.isArray(t),object: t=>"object"==typeof t&&!A.array(t),date: t=>t instanceof Date,timestamp(t){return!(!this.integer(t)||Math.abs(t).toString().length>16)},file: t=>"string"==typeof t.url,email: t=>"string"==typeof t&&!!t.match(_.email)&&t.length<255,url: t=>"string"==typeof t&&!!t.match(_.url),pattern(t, e){try{return new RegExp(t).test(e)}catch(i){return!1}},method: t=>"function"==typeof t,idcard: t=>"string"==typeof t&&!!t.match(_.idcard),"url-https"(t){return this.url(t)&&t.startsWith("https://")},"url-scheme": t=>t.startsWith("://"),"url-web": t=>!1};class I{constructor(t){this._message=t}async validateRule(t, e, i, s, a){var r=null;let o=e.rules;if(o.findIndex((t=>t.required))<0){if(null==i)return r;if("string"==typeof i&&!i.length)return r}var n=this._message;if(void 0===o)return n.default;for(var l=0; l<o.length; l++){let u=o[l],h=this._getValidateType(u);if(Object.assign(u,{label:e.label||`["${t}"]`}),j[h]&&null!=(r=j[h](u,i,n)))break;if(u.validateExpr){let t=Date.now();if(!1===u.validateExpr(i,a,t)){r=this._getMessage(u,u.errorMessage||this._message.default);break}}if(u.validateFunction&&null!==(r=await this.validateFunction(u,i,s,a,h)))break}return null!==r&&(r=n.TAG+r),r}async validateFunction(t, e, i, s, a){let r=null;try{let o=null;const n=await t.validateFunction(t,e,s||i,(t=>{o=t}));(o||"string"==typeof n&&n||!1===n)&&(r=this._getMessage(t,o||n,a))}catch(o){r=this._getMessage(t,o.message,a)}return r}_getMessage(t, e, i){return M(t,e||t.errorMessage||this._message[i]||e.default)}_getValidateType(t){var e="";return t.required?e="required":t.format?e="format":t.arrayType?e="arrayTypeFormat":t.range?e="range":void 0!==t.maximum||void 0!==t.minimum?e="rangeNumber":void 0!==t.maxLength||void 0!==t.minLength?e="rangeLength":t.pattern?e="pattern":t.validateFunction&&(e="validateFunction"),e}}const j={required:(t, e, i)=>t.required&&function(t, e){return null==t||"string"==typeof t&&!t||!(!Array.isArray(t)||t.length)||"object"===e&&!Object.keys(t).length}(e,t.format||typeof e)?M(t,t.errorMessage||i.required):null,range(t, e, i){const{range:s,errorMessage:a}=t;let r=new Array(s.length);for(let n=0; n<s.length; n++){const t=s[n];A.object(t)&&void 0!==t.value?r[n]=t.value:r[n]=t}let o=!1;return Array.isArray(e)?o=new Set(e.concat(r)).size===r.length:r.indexOf(e)>-1&&(o=!0),o?null:M(t,a||i.enum)},rangeNumber(t, e, i){if(!A.number(e))return M(t,t.errorMessage||i.pattern.mismatch);let{minimum:s,maximum:a,exclusiveMinimum:r,exclusiveMaximum:o}=t,n=r?e<=s:e<s,l=o?e>=a:e>a;return void 0!==s&&n?M(t,t.errorMessage||i.number[r?"exclusiveMinimum":"minimum"]):void 0!==a&&l?M(t,t.errorMessage||i.number[o?"exclusiveMaximum":"maximum"]):void 0!==s&&void 0!==a&&(n||l)?M(t,t.errorMessage||i.number.range):null},rangeLength(t, e, i){if(!A.string(e)&&!A.array(e))return M(t,t.errorMessage||i.pattern.mismatch);let s=t.minLength,a=t.maxLength,r=e.length;return void 0!==s&&r<s?M(t,t.errorMessage||i.length.minLength):void 0!==a&&r>a?M(t,t.errorMessage||i.length.maxLength):void 0!==s&&void 0!==a&&(r<s||r>a)?M(t,t.errorMessage||i.length.range):null},pattern:(t, e, i)=>A.pattern(t.pattern,e)?null:M(t,t.errorMessage||i.pattern.mismatch),format(t, e, i){var s=Object.keys(A),a=T[t.format]?T[t.format]:t.format||t.arrayType;return s.indexOf(a)>-1&&!A[a](e)?M(t,t.errorMessage||i.typeError):null},arrayTypeFormat(t, e, i){if(!Array.isArray(e))return M(t,t.errorMessage||i.typeError);for(let s=0; s<e.length; s++){const a=e[s];let r=this.format(t,a,i);if(null!==r)return r}return null}};class P extends I{constructor(t, e){super(P.message),this._schema=t,this._options=e||null}updateSchema(t){this._schema=t}async validate(t, e){let i=this._checkFieldInSchema(t);return i||(i=await this.invokeValidate(t,!1,e)),i.length?i[0]:null}async validateAll(t, e){let i=this._checkFieldInSchema(t);return i||(i=await this.invokeValidate(t,!0,e)),i}async validateUpdate(t, e){let i=this._checkFieldInSchema(t);return i||(i=await this.invokeValidateUpdate(t,!1,e)),i.length?i[0]:null}async invokeValidate(t, e, i){let s=[],a=this._schema;for(let r in a){let o=a[r],n=await this.validateRule(r,o,t[r],t,i);if(null!=n&&(s.push({key:r,errorMessage:n}),!e))break}return s}async invokeValidateUpdate(t, e, i){let s=[];for(let a in t){let r=await this.validateRule(a,this._schema[a],t[a],t,i);if(null!=r&&(s.push({key:a,errorMessage:r}),!e))break}return s}_checkFieldInSchema(t){var e=Object.keys(t),i=Object.keys(this._schema);if(new Set(e.concat(i)).size===i.length)return"";var s=e.filter((t=>i.indexOf(t)<0));return[{key:"invalid",errorMessage:M({field:JSON.stringify(s)},P.message.TAG+P.message.defaultInvalid)}]}}P.message=new function(){return{TAG:"",default:"验证错误",defaultInvalid:"提交的字段{field}在数据库中并不存在",validateFunction:"验证无效",required:"{label}必填",enum:"{label}超出范围",timestamp:"{label}格式无效",whitespace:"{label}不能为空",typeError:"{label}类型无效",date:{format:"{label}日期{value}格式无效",parse:"{label}日期无法解析,{value}无效",invalid:"{label}日期{value}无效"},length:{minLength:"{label}长度不能少于{minLength}",maxLength:"{label}长度不能超过{maxLength}",range:"{label}必须介于{minLength}和{maxLength}之间"},number:{minimum:"{label}不能小于{minimum}",maximum:"{label}不能大于{maximum}",exclusiveMinimum:"{label}不能小于等于{minimum}",exclusiveMaximum:"{label}不能大于等于{maximum}",range:"{label}必须介于{minimum}and{maximum}之间"},pattern:{mismatch:"{label}格式不匹配"}}};const B=(t, e, i)=>{const s=i.find((t=>{return t.format&&("int"===(e=t.format)||"double"===e||"number"===e||"timestamp"===e);var e})),a=i.find((t=>t.format&&"boolean"===t.format||"bool"===t.format));return s&&(e=e||0===e?D(Number(e))?Number(e):e:null),a&&(e=!!z(e)&&e),e},R=(t, e)=>E(e,t),V=(t, e={})=>{const i=N(t);if("object"==typeof i&&Array.isArray(i)&&i.length>1){return i.reduce(((t, e)=>t+`#${e}`),"_formdata_")}return i[0]||t},F= t=>{let e=t.replace("_formdata_#","");return e=e.split("#").map((t=>D(t)?Number(t):t)),e},O=(t, e, i)=>("object"!=typeof t||N(e).reduce(((t, e, s, a)=>s===a.length-1?(t[e]=i,null):(e in t||(t[e]=/^[0-9]{1,}$/.test(a[s+1])?[]:{}),t[e])),t),t);function N(t){return Array.isArray(t)?t:t.replace(/\[/g,".").replace(/\]/g,"").split(".")}const E=(t, e, i="undefined")=>{let s=N(e).reduce(((t, e)=>(t||{})[e]),t);return s&&void 0===s?i:s},D= t=>!isNaN(Number(t)),z= t=>"boolean"==typeof t;const L=t({name:"uniForms",emits:["validate","submit"],options:{virtualHost:!0},props:{value:{type:Object,default:()=>null},modelValue:{type:Object,default:()=>null},model:{type:Object,default:()=>null},rules:{type:Object,default:()=>({})},errShowType:{type:String,default:"undertext"},validateTrigger:{type:String,default:"submit"},labelPosition:{type:String,default:"left"},labelWidth:{type:[String,Number],default:""},labelAlign:{type:String,default:"left"},border:{type:Boolean,default:!1}},provide(){return{uniForm:this}},data:()=>({formData:{},formRules:{}}),computed:{localData(){const t=this.model||this.modelValue||this.value;return t?(e=t,JSON.parse(JSON.stringify(e))):{};var e}},watch:{rules:{handler:function(t, e){this.setRules(t)},deep:!0,immediate:!0}},created(){b().$vm.$.appContext.config.globalProperties.binddata||(b().$vm.$.appContext.config.globalProperties.binddata=function(t, e, i){if(i)this.$refs[i].setValue(t,e);else{let i;for(let t in this.$refs){const e=this.$refs[t];if(e&&e.$options&&"uniForms"===e.$options.name){i=e;break}}if(!i)return console.error("当前 uni-froms 组件缺少 ref 属性");i.model&&(i.model[t]=e),i.modelValue&&(i.modelValue[t]=e),i.value&&(i.value[t]=e)}}),this.childrens=[],this.inputChildrens=[],this.setRules(this.rules)},methods:{setRules(t){this.formRules=Object.assign({},this.formRules,t),this.validator=new P(t)},setValue(t, e){let i=this.childrens.find((e=>e.name===t));return i?(this.formData[t]=B(0,e,this.formRules[t]&&this.formRules[t].rules||[]),i.onFieldChange(this.formData[t])):null},validate(t, e){return this.checkAll(this.formData,t,e)},validateField(t=[], e){t=[].concat(t);let i={};return this.childrens.forEach((e=>{const s=V(e.name);-1!==t.indexOf(s)&&(i=Object.assign({},i,{[s]:this.formData[s]}))})),this.checkAll(i,[],e)},clearValidate(t=[]){t=[].concat(t),this.childrens.forEach((e=>{if(0===t.length)e.errMsg="";else{const i=V(e.name);-1!==t.indexOf(i)&&(e.errMsg="")}}))},submit(t, e, i){for(let s in this.dataValue){this.childrens.find((t=>t.name===s))&&void 0===this.formData[s]&&(this.formData[s]=this._getValue(s,this.dataValue[s]))}return i||console.warn("submit 方法即将废弃，请使用validate方法代替！"),this.checkAll(this.formData,t,e,"submit")},async checkAll(t, e, i, s){if(!this.validator)return;let a,r=[];for(let u in t){const t=this.childrens.find((t=>V(t.name)===u));t&&r.push(t)}i||"function"!=typeof e||(i=e),!i&&"function"!=typeof i&&Promise&&(a=new Promise(((t, e)=>{i=function(i, s){i?e(i):t(s)}})));let o=[],n=JSON.parse(JSON.stringify(t));for(let u in r){const t=r[u];let e=V(t.name);const i=await t.onFieldChange(n[e]);if(i&&(o.push(i),"toast"===this.errShowType||"modal"===this.errShowType))break}Array.isArray(o)&&0===o.length&&(o=null),Array.isArray(e)&&e.forEach((t=>{let e=V(t),i=R(t,this.localData);void 0!==i&&(n[e]=i)})),"submit"===s?this.$emit("submit",{detail:{value:n,errors:o}}):this.$emit("validate",o);let l={};return l=((t={})=>{let e=JSON.parse(JSON.stringify(t)),i={};for(let s in e){let t=F(s);O(i,t,e[s])}return i})(n,this.name),i&&"function"==typeof i&&i(o,l),a&&i?a:null},validateCheck(t){this.$emit("validate",t)},_getValue:B,_isRequiredField: t=>{let e=!1;for(let i=0; i<t.length; i++){if(t[i].required){e=!0;break}}return e},_setDataValue:(t, e, i)=>(e[t]=i,i||""),_getDataValue:R,_realName:V,_isRealName: t=>/^_formdata_#*/.test(t),_isEqual:(t, e)=>{if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;var i=toString.call(t);if(i!==toString.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e}if("[object Object]"==i){var s=Object.getOwnPropertyNames(t),a=Object.getOwnPropertyNames(e);if(s.length!=a.length)return!1;for(var r=0; r<s.length; r++){var o=s[r];if(t[o]!==e[o])return!1}return!0}return"[object Array]"==i?t.toString()==e.toString():void 0}}},[["render",function(t, e, i, s, u, h){const c=y,m=l;return r(),a(m,{class:"uni-forms"},{default:o((()=>[n(c,null,{default:o((()=>[d(t.$slots,"default",{},void 0,!0)])),_:3})])),_:3})}],["__scopeId","data-v-7dfa1ccf"]]),H={data:()=>({}),created(){this.popup=this.getParent()},methods:{getParent(t="uniPopup"){let e=this.$parent,i=e.$options.name;for(; i!==t;){if(e=e.$parent,!e)return!1;i=e.$options.name}return e}}};class q{constructor(t, e){this.options=t,this.animation=k({...t}),this.currentStepAnimates={},this.next=0,this.$=e}_nvuePushAnimates(t, e){let i=this.currentStepAnimates[this.next],s={};if(s=i||{styles:{},config:{}},X.includes(t)){s.styles.transform||(s.styles.transform="");let i="";"rotate"===t&&(i="deg"),s.styles.transform+=`${t}(${e+i}) `}else s.styles[t]=`${e}`;this.currentStepAnimates[this.next]=s}_animateRun(t={}, e={}){let i=this.$.$refs.ani.ref;if(i)return new Promise(((s, a)=>{nvueAnimation.transition(i,{styles:t,...e},(t=>{s()}))}))}_nvueNextAnimate(t, e=0, i){let s=t[e];if(s){let{styles:a,config:r}=s;this._animateRun(a,r).then((()=>{e+=1,this._nvueNextAnimate(t,e,i)}))}else this.currentStepAnimates={},"function"==typeof i&&i(),this.isEnd=!0}step(t={}){return this.animation.step(t),this}run(t){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((()=>{"function"==typeof t&&t()}),this.$.durationTime)}}const X=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function Y(t, e){if(e)return clearTimeout(e.timer),new q(t,e)}X.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((t=>{q.prototype[t]=function(...e){return this.animation[t](...e),this}}));const J=t({name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default:()=>"fade"},duration:{type:Number,default:300},styles:{type:Object,default:()=>({})},customClass:{type:String,default:""},onceRender:{type:Boolean,default:!1}},data:()=>({isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(t){t?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let t={...this.styles,"transition-duration":this.duration/1e3+"s"},e="";for(let i in t){e+=this.toLine(i)+":"+t[i]+";"}return e},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(t={}){t.duration&&(this.durationTime=t.duration),this.animation=Y(Object.assign(this.config,t),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(t, e={}){if(this.animation){for(let e in t)try{"object"==typeof t[e]?this.animation[e](...t[e]):this.animation[e](t[e])}catch(i){console.error(`方法 ${e} 不存在`)}return this.animation.step(e),this}},run(t){this.animation&&this.animation.run(t)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:t,transform:e}=this.styleInit(!1);void 0!==t&&(this.opacity=t),this.transform=e,this.$nextTick((()=>{this.timer=setTimeout((()=>{this.animation=Y(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})}),20)}))},close(t){this.animation&&this.tranfromInit(!0).step().run((()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:t,transform:e}=this.styleInit(!1);this.opacity=t||1,this.transform=e,this.$emit("change",{detail:this.isShow})}))},styleInit(t){let e={transform:""},i=(t, i)=>{"fade"===i?e.opacity=this.animationType(t)[i]:e.transform+=this.animationType(t)[i]+" "};return"string"==typeof this.modeClass?i(t,this.modeClass):this.modeClass.forEach((e=>{i(t,e)})),e},tranfromInit(t){let e=(t, e)=>{let i=null;"fade"===e?i=t?0:1:(i=t?"-100%":"0","zoom-in"===e&&(i=t?.8:1),"zoom-out"===e&&(i=t?1.2:1),"slide-right"===e&&(i=t?"100%":"0"),"slide-bottom"===e&&(i=t?"100%":"0")),this.animation[this.animationMode()[e]](i)};return"string"==typeof this.modeClass?e(t,this.modeClass):this.modeClass.forEach((i=>{e(t,i)})),this.animation},animationType: t=>({fade:t?0:1,"slide-top":`translateY(${t?"0":"-100%"})`,"slide-right":`translateX(${t?"0":"100%"})`,"slide-bottom":`translateY(${t?"0":"100%"})`,"slide-left":`translateX(${t?"0":"-100%"})`,"zoom-in":`scaleX(${t?1:.8}) scaleY(${t?1:.8})`,"zoom-out":`scaleX(${t?1:1.2}) scaleY(${t?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine: t=>t.replace(/([A-Z])/g,"-$1").toLowerCase()}},[["render",function(t, e, i, s, n, c){const m=l;return v((r(),a(m,{ref:"ani",animation:n.animationData,class:h(i.customClass),style:u(c.transformStyles),onClick:c.onClick},{default:o((()=>[d(t.$slots,"default")])),_:3},8,["animation","class","style","onClick"])),[[w,n.isShow]])}]]);const W=t({name:"uniPopup",components:{keypress:{name:"Keypress",props:{disable:{type:Boolean,default:!1}},mounted(){const t={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]};document.addEventListener("keyup",(e=>{if(this.disable)return;const i=Object.keys(t).find((i=>{const s=e.key,a=t[i];return a===s||Array.isArray(a)&&a.includes(s)}));i&&setTimeout((()=>{this.$emit(i,{})}),0)}))},render:()=>{}}},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},isMaskClick:{type:Boolean,default:null},maskClick:{type:Boolean,default:null},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBackgroundColor:{type:String,default:"rgba(0, 0, 0, 0.4)"},borderRadius:{type:String}},watch:{type:{handler:function(t){this.config[t]&&this[this.config[t]](!0)},immediate:!0},isDesktop:{handler:function(t){this.config[t]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(t){this.mkclick=t},immediate:!0},isMaskClick:{handler:function(t){this.mkclick=t},immediate:!0},showPopup(t){document.getElementsByTagName("body")[0].style.overflow=t?"hidden":"visible"}},data(){return{duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},maskClass:{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.4)"},transClass:{backgroundColor:"transparent",borderRadius:this.borderRadius||"0",position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:"top"}},computed:{getStyles(){let t={backgroundColor:this.bg};return this.borderRadius,t=Object.assign(t,{borderRadius:this.borderRadius}),t},isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return""===this.backgroundColor||"none"===this.backgroundColor?"transparent":this.backgroundColor}},mounted(){(()=>{const{windowWidth:t,windowHeight:e,windowTop:i,safeArea:s,screenHeight:a,safeAreaInsets:r}=C();this.popupWidth=t,this.popupHeight=e+(i||0),s&&this.safeArea?this.safeAreaInsets=r.bottom:this.safeAreaInsets=0})()},unmounted(){this.setH5Visible()},activated(){this.setH5Visible(!this.showPopup)},deactivated(){this.setH5Visible(!0)},created(){null===this.isMaskClick&&null===this.maskClick?this.mkclick=!0:this.mkclick=null!==this.isMaskClick?this.isMaskClick:this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1,this.maskClass.backgroundColor=this.maskBackgroundColor},methods:{setH5Visible(t=!0){document.getElementsByTagName("body")[0].style.overflow=t?"visible":"hidden"},closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(t){t.stopPropagation(),this.clearPropagation=!0},open(t){if(this.showPopup)return;t&&-1!==["top","center","bottom","left","right","message","dialog","share"].indexOf(t)||(t=this.type),this.config[t]?(this[this.config[t]](),this.$emit("change",{show:!0,type:t})):console.error("缺少类型：",t)},close(t){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.showPopup=!1}),300)},touchstart(){this.clearPropagation=!1},onTap(){this.clearPropagation?this.clearPropagation=!1:(this.$emit("maskClick"),this.mkclick&&this.close())},top(t){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},t||(this.showPopup=!0,this.showTrans=!0,this.$nextTick((()=>{this.showPoptrans(),this.messageChild&&"message"===this.type&&this.messageChild.timerClose()})))},bottom(t){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:this.safeAreaInsets+"px",backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},t||this.showPoptrans()},center(t){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center",borderRadius:this.borderRadius||"0"},t||this.showPoptrans()},left(t){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},t||this.showPoptrans()},right(t){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},t||this.showPoptrans()},showPoptrans(){this.$nextTick((()=>{this.showPopup=!0,this.showTrans=!0}))}}},[["render",function(t, i, m, p, f, g){const y=e(s("uni-transition"),J),b=l,k=x("keypress");return f.showPopup?(r(),a(b,{key:0,class:h(["uni-popup",[f.popupstyle,g.isDesktop?"fixforpc-z-index":""]])},{default:o((()=>[n(b,{onTouchstart:g.touchstart},{default:o((()=>[f.maskShow?(r(),a(y,{key:"1",name:"mask","mode-class":"fade",styles:f.maskClass,duration:f.duration,show:f.showTrans,onClick:g.onTap},null,8,["styles","duration","show","onClick"])):c("",!0),n(y,{key:"2","mode-class":f.ani,name:"content",styles:f.transClass,duration:f.duration,show:f.showTrans,onClick:g.onTap},{default:o((()=>[n(b,{class:h(["uni-popup__wrapper",[f.popupstyle]]),style:u(g.getStyles),onClick:g.clear},{default:o((()=>[d(t.$slots,"default",{},void 0,!0)])),_:3},8,["style","class","onClick"])])),_:3},8,["mode-class","styles","duration","show","onClick"])])),_:3},8,["onTouchstart"]),f.maskShow?(r(),a(k,{key:0,onEsc:g.onTap},null,8,["onEsc"])):c("",!0)])),_:3},8,["class"])):c("",!0)}],["__scopeId","data-v-c96125a2"]]);export{$ as _,L as a,W as b,H as p};
